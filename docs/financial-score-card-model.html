<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Financial Score Card Model | Arsenal Repository</title>
  <meta name="description" content="Chapter 2 Financial Score Card Model | Arsenal Repository" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Financial Score Card Model | Arsenal Repository" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Financial Score Card Model | Arsenal Repository" />
  
  
  

<meta name="author" content="Aidan Miller" />


<meta name="date" content="2023-07-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="evaluate-the-initial-model---training-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Arsenal Repo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> The Arsenal Repository</a></li>
<li class="chapter" data-level="2" data-path="financial-score-card-model.html"><a href="financial-score-card-model.html"><i class="fa fa-check"></i><b>2</b> Financial Score Card Model</a></li>
<li class="chapter" data-level="3" data-path="evaluate-the-initial-model---training-data.html"><a href="evaluate-the-initial-model---training-data.html"><i class="fa fa-check"></i><b>3</b> Evaluate the Initial Model - Training Data</a></li>
<li class="chapter" data-level="4" data-path="add-scores-to-initial-model-on-training-data.html"><a href="add-scores-to-initial-model-on-training-data.html"><i class="fa fa-check"></i><b>4</b> Add Scores to Initial Model on Training Data</a></li>
<li class="chapter" data-level="5" data-path="reject-inference---clean-prepare-reject-data.html"><a href="reject-inference---clean-prepare-reject-data.html"><i class="fa fa-check"></i><b>5</b> Reject Inference - Clean &amp; Prepare Reject Data</a></li>
<li class="chapter" data-level="6" data-path="reject-inference---clean-prepare-reject-data-1.html"><a href="reject-inference---clean-prepare-reject-data-1.html"><i class="fa fa-check"></i><b>6</b> Reject Inference - Clean &amp; Prepare Reject Data</a></li>
<li class="chapter" data-level="7" data-path="add-scores-to-train-comb-from-final-model.html"><a href="add-scores-to-train-comb-from-final-model.html"><i class="fa fa-check"></i><b>7</b> Add Scores to Train Comb from Final Model</a></li>
<li class="chapter" data-level="8" data-path="add-scores-to-test-comb-from-final-model.html"><a href="add-scores-to-test-comb-from-final-model.html"><i class="fa fa-check"></i><b>8</b> Add Scores to Test Comb from Final Model</a></li>
<li class="chapter" data-level="9" data-path="a-caucus-race-and-a-long-tale.html"><a href="a-caucus-race-and-a-long-tale.html"><i class="fa fa-check"></i><b>9</b> A caucus-race and a long tale</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Arsenal Repository</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="financial-score-card-model" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Financial Score Card Model<a href="financial-score-card-model.html#financial-score-card-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Loading in Packages</p>
<p>Reading in Data</p>
<p>Preview Data</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="financial-score-card-model.html#cb1-1" tabindex="-1"></a><span class="fu">head</span>(accepted)</span></code></pre></div>
<pre><code>##   CHILDREN PERS_H AGE TMADD TMJOB1 TEL NMBLOAN FINLOAN INCOME EC_CARD BUREAU LOCATION LOANS REGN DIV CASH             PRODUCT RESID
## 1        0      2  51     3    999   2       0       0   1000       1      1        1     2    2   1 1300 Furniture or Carpet Lease
## 2        1      2  55    60    999   2       2       0   2900       0      1        1     1    2   1  900 Furniture or Carpet Owner
## 3        0      1  50    72    999   2       2       0   2300       0      1        1     1    0   0 1100 Radio or TV or Hifi Lease
## 4        0      2  56    96    999   2       2       1   4000       0      3        1     0    0   0 7000 Furniture or Carpet Lease
## 5        0      1  52   120    999   2       0       0      0       1      1        1     1    0   0 1200 Furniture or Carpet Lease
## 6        0      1  63   144    999   2       2       1   2200       0      3        1     0    4   1 4000 Furniture or Carpet Lease
##      NAT          PROF             CAR           CARDS GB _freq_
## 1 German        Others             Car     Cheque card  0     30
## 2 German        Others             Car no credit cards  0     30
## 3 German        Others Without Vehicle no credit cards  0     30
## 4 German Civil Service             Car no credit cards  0     30
## 5 German        Others             Car     Cheque card  0     30
## 6 German     Pensioner Without Vehicle no credit cards  0     30</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="financial-score-card-model.html#cb3-1" tabindex="-1"></a><span class="fu">head</span>(rejected)</span></code></pre></div>
<pre><code>##   CHILDREN PERS_H AGE TMADD TMJOB1 TEL NMBLOAN FINLOAN INCOME EC_CARD BUREAU LOCATION LOANS REGN DIV CASH          PRODUCT RESID
## 1        0      1  24     6     18   1       0       0      0       1      3        1     0    0   0  500 Dept. Store,Mail Lease
## 2        1      2  35    84     54   1       0       0   2500       0      2        1     0    3   1 1700 Furniture,Carpet Lease
## 3        1      3  26    36    108   2       0       1   2600       0      1        1     2    0   0  900  Radio, TV, Hifi Owner
## 4        2      3  35   168     15   1       0       0   1600       0      3        1     0    0   0 1200  Radio, TV, Hifi  &lt;NA&gt;
## 5        0      1  20   240      9   2       0       0      0       1      3        1     0    0   0 4000 Furniture,Carpet Lease
## 6        2      4  29    30      9   2       2       0   1700       0      3        1     0    0   0 2000  Radio, TV, Hifi Lease
##            NAT             PROF             CAR           CARDS
## 1 East Germany           Others             Car     Cheque card
## 2 East Germany Food,Building,Ca Without Vehicle no credit cards
## 3 East Germany           Others             Car no credit cards
## 4 East Germany           Others Without Vehicle no credit cards
## 5 East Germany           Others Without Vehicle     Cheque card
## 6 East Germany           Others Without Vehicle no credit cards</code></pre>
<p>Looking at Accepts Data Closer</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="financial-score-card-model.html#cb5-1" tabindex="-1"></a><span class="co">#GB is our target var 0 is good and 1 is bad</span></span>
<span id="cb5-2"><a href="financial-score-card-model.html#cb5-2" tabindex="-1"></a><span class="fu">str</span>(accepted)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3000 obs. of  24 variables:
##  $ CHILDREN: num  0 1 0 0 0 0 0 2 0 1 ...
##  $ PERS_H  : num  2 2 1 2 1 1 2 4 2 3 ...
##  $ AGE     : num  51 55 50 56 52 63 47 51 51 54 ...
##  $ TMADD   : num  3 60 72 96 120 144 168 168 168 168 ...
##  $ TMJOB1  : num  999 999 999 999 999 999 999 999 999 999 ...
##  $ TEL     : num  2 2 2 2 2 2 2 2 2 2 ...
##  $ NMBLOAN : num  0 2 2 2 0 2 0 0 0 0 ...
##  $ FINLOAN : num  0 0 0 1 0 1 0 1 0 0 ...
##  $ INCOME  : num  1000 2900 2300 4000 0 2200 0 5000 2800 0 ...
##  $ EC_CARD : num  1 0 0 0 1 0 0 0 0 1 ...
##  $ BUREAU  : num  1 1 1 3 1 3 1 1 3 1 ...
##  $ LOCATION: num  1 1 1 1 1 1 1 1 1 1 ...
##  $ LOANS   : num  2 1 1 0 1 0 1 1 0 3 ...
##  $ REGN    : num  2 2 0 0 0 4 0 3 4 5 ...
##  $ DIV     : num  1 1 0 0 0 1 0 1 1 1 ...
##  $ CASH    : num  1300 900 1100 7000 1200 4000 1900 5000 6000 4000 ...
##  $ PRODUCT : chr  &quot;Furniture or Carpet&quot; &quot;Furniture or Carpet&quot; &quot;Radio or TV or Hifi&quot; &quot;Furniture or Carpet&quot; ...
##  $ RESID   : chr  &quot;Lease&quot; &quot;Owner&quot; &quot;Lease&quot; &quot;Lease&quot; ...
##  $ NAT     : chr  &quot;German&quot; &quot;German&quot; &quot;German&quot; &quot;German&quot; ...
##  $ PROF    : chr  &quot;Others&quot; &quot;Others&quot; &quot;Others&quot; &quot;Civil Service&quot; ...
##  $ CAR     : chr  &quot;Car&quot; &quot;Car&quot; &quot;Without Vehicle&quot; &quot;Car&quot; ...
##  $ CARDS   : chr  &quot;Cheque card&quot; &quot;no credit cards&quot; &quot;no credit cards&quot; &quot;no credit cards&quot; ...
##  $ GB      : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ _freq_  : num  30 30 30 30 30 30 30 30 30 30 ...</code></pre>
<p>Removing Vars That should not be taken into consideration when dealing with loans</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="financial-score-card-model.html#cb7-1" tabindex="-1"></a>accepts<span class="ot">=</span> accepted <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="financial-score-card-model.html#cb7-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AGE, <span class="sc">-</span>DIV, <span class="sc">-</span>NAT) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="financial-score-card-model.html#cb7-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">good=</span> <span class="fu">ifelse</span>(GB<span class="sc">==</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-4"><a href="financial-score-card-model.html#cb7-4" tabindex="-1"></a>         <span class="at">PERS_H=</span> <span class="fu">ifelse</span>(PERS_H<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="st">&#39;7+&#39;</span>, PERS_H),</span>
<span id="cb7-5"><a href="financial-score-card-model.html#cb7-5" tabindex="-1"></a>         <span class="at">CARDS=</span> <span class="fu">ifelse</span>(CARDS<span class="sc">==</span><span class="st">&#39;VISA mybank&#39;</span>, <span class="st">&#39;Other credit car&#39;</span>, CARDS),</span>
<span id="cb7-6"><a href="financial-score-card-model.html#cb7-6" tabindex="-1"></a>         <span class="at">CARDS=</span> <span class="fu">ifelse</span>(CARDS<span class="sc">==</span><span class="st">&#39;VISA Others&#39;</span>, <span class="st">&#39;Other credit car&#39;</span>, CARDS),</span>
<span id="cb7-7"><a href="financial-score-card-model.html#cb7-7" tabindex="-1"></a>         <span class="at">CARDS=</span> <span class="fu">ifelse</span>(CARDS<span class="sc">==</span><span class="st">&#39;American Express&#39;</span>, <span class="st">&#39;Other credit car&#39;</span>, CARDS),</span>
<span id="cb7-8"><a href="financial-score-card-model.html#cb7-8" tabindex="-1"></a>         <span class="at">GB=</span><span class="fu">ifelse</span>(GB<span class="sc">==</span><span class="st">&quot;0&quot;</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="financial-score-card-model.html#cb8-1" tabindex="-1"></a>accepts <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(n_distinct)</span></code></pre></div>
<pre><code>##   CHILDREN PERS_H TMADD TMJOB1 TEL NMBLOAN FINLOAN INCOME EC_CARD BUREAU LOCATION LOANS REGN CASH PRODUCT RESID PROF CAR CARDS GB
## 1        9      7    32     33   3       3       2     27       2      3        2     9    9   29       7     3   10   3     4  2
##   _freq_ good
## 1      2    2</code></pre>
<p>Getting all the Factor Variables from the accepts dataset</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="financial-score-card-model.html#cb10-1" tabindex="-1"></a>factor_vars<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb10-2"><a href="financial-score-card-model.html#cb10-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(accepts))){</span>
<span id="cb10-3"><a href="financial-score-card-model.html#cb10-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">colnames</span>(accepts)[i] <span class="sc">==</span> <span class="st">&#39;good&#39;</span>){</span>
<span id="cb10-4"><a href="financial-score-card-model.html#cb10-4" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb10-5"><a href="financial-score-card-model.html#cb10-5" tabindex="-1"></a>  }</span>
<span id="cb10-6"><a href="financial-score-card-model.html#cb10-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(accepts[,i]))<span class="sc">&lt;</span><span class="dv">15</span>){</span>
<span id="cb10-7"><a href="financial-score-card-model.html#cb10-7" tabindex="-1"></a>    factor_vars<span class="ot">=</span><span class="fu">append</span>(factor_vars,<span class="fu">colnames</span>(accepts[i]))</span>
<span id="cb10-8"><a href="financial-score-card-model.html#cb10-8" tabindex="-1"></a>  }</span>
<span id="cb10-9"><a href="financial-score-card-model.html#cb10-9" tabindex="-1"></a>}</span>
<span id="cb10-10"><a href="financial-score-card-model.html#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="financial-score-card-model.html#cb10-11" tabindex="-1"></a>factor_vars</span></code></pre></div>
<pre><code>##  [1] &quot;CHILDREN&quot; &quot;PERS_H&quot;   &quot;TEL&quot;      &quot;NMBLOAN&quot;  &quot;FINLOAN&quot;  &quot;EC_CARD&quot;  &quot;BUREAU&quot;   &quot;LOCATION&quot; &quot;LOANS&quot;    &quot;REGN&quot;     &quot;PRODUCT&quot;  &quot;RESID&quot;   
## [13] &quot;PROF&quot;     &quot;CAR&quot;      &quot;CARDS&quot;    &quot;GB&quot;       &quot;_freq_&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="financial-score-card-model.html#cb12-1" tabindex="-1"></a>accepts[,factor_vars] <span class="ot">=</span> <span class="fu">lapply</span>(accepts[,factor_vars] , factor)</span>
<span id="cb12-2"><a href="financial-score-card-model.html#cb12-2" tabindex="-1"></a><span class="co">#str(accepts)</span></span>
<span id="cb12-3"><a href="financial-score-card-model.html#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="financial-score-card-model.html#cb12-4" tabindex="-1"></a><span class="co">#      OR        #</span></span>
<span id="cb12-5"><a href="financial-score-card-model.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="financial-score-card-model.html#cb12-6" tabindex="-1"></a><span class="co">#for (i in (1:ncol(accepts))){</span></span>
<span id="cb12-7"><a href="financial-score-card-model.html#cb12-7" tabindex="-1"></a>  <span class="co">#if (colnames(accepts)[i] == &#39;good&#39;){</span></span>
<span id="cb12-8"><a href="financial-score-card-model.html#cb12-8" tabindex="-1"></a>    <span class="co">#break</span></span>
<span id="cb12-9"><a href="financial-score-card-model.html#cb12-9" tabindex="-1"></a>  <span class="co">#}</span></span>
<span id="cb12-10"><a href="financial-score-card-model.html#cb12-10" tabindex="-1"></a>  <span class="co">#if (length(unique(accepts[,i]))&lt;15){</span></span>
<span id="cb12-11"><a href="financial-score-card-model.html#cb12-11" tabindex="-1"></a>    <span class="co">#accepts[,i]=as.factor(accepts[,i])</span></span>
<span id="cb12-12"><a href="financial-score-card-model.html#cb12-12" tabindex="-1"></a>  <span class="co">#}</span></span>
<span id="cb12-13"><a href="financial-score-card-model.html#cb12-13" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="financial-score-card-model.html#cb13-1" tabindex="-1"></a>accepts<span class="sc">$</span>good<span class="ot">=</span> <span class="fu">as.numeric</span>(accepts<span class="sc">$</span>good)</span>
<span id="cb13-2"><a href="financial-score-card-model.html#cb13-2" tabindex="-1"></a><span class="fu">table</span>(accepted<span class="sc">$</span>GB)</span></code></pre></div>
<pre><code>## 
##    0    1 
## 1500 1500</code></pre>
<p>Creating Train Test Population</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="financial-score-card-model.html#cb15-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0119</span>)</span>
<span id="cb15-2"><a href="financial-score-card-model.html#cb15-2" tabindex="-1"></a>train_id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(accepts)), <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.70</span><span class="sc">*</span><span class="fu">nrow</span>(accepts)))</span>
<span id="cb15-3"><a href="financial-score-card-model.html#cb15-3" tabindex="-1"></a>train <span class="ot">&lt;-</span> accepts[train_id, ]</span>
<span id="cb15-4"><a href="financial-score-card-model.html#cb15-4" tabindex="-1"></a>test <span class="ot">&lt;-</span> accepts[<span class="sc">-</span>train_id, ]</span>
<span id="cb15-5"><a href="financial-score-card-model.html#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="financial-score-card-model.html#cb15-6" tabindex="-1"></a><span class="fu">table</span>(train<span class="sc">$</span>good)</span></code></pre></div>
<pre><code>## 
##    0    1 
## 1060 1040</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="financial-score-card-model.html#cb17-1" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>good)</span></code></pre></div>
<pre><code>## 
##   0   1 
## 440 460</code></pre>
<hr />
<hr />
<p>Selecting + Binning Just the Important Vars</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="financial-score-card-model.html#cb19-1" tabindex="-1"></a><span class="co">#Selecting only important vars</span></span>
<span id="cb19-2"><a href="financial-score-card-model.html#cb19-2" tabindex="-1"></a>iv_summary <span class="ot">&lt;-</span> <span class="fu">smbinning.sumiv</span>(<span class="at">df =</span> train, <span class="at">y =</span> <span class="st">&quot;good&quot;</span>)</span></code></pre></div>
<pre><code>##  
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |--                                                |   5%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-----                                             |   9%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-------                                           |  14%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |---------                                         |  18%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-----------                                       |  23%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |--------------                                    |  27%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |----------------                                  |  32%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |------------------                                |  36%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |--------------------                              |  41%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-----------------------                           |  45%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-------------------------                         |  50%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |---------------------------                       |  55%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |------------------------------                    |  59%
  |                                                        
  |--------------------------------                  |  64%
  |                                                        
  |----------------------------------                |  68%
  |                                                        
  |------------------------------------              |  73%
  |                                                        
  |---------------------------------------           |  77%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-----------------------------------------         |  82%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |-------------------------------------------       |  86%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |---------------------------------------------     |  91%</code></pre>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<pre><code>## 
  |                                                        
  |------------------------------------------------  |  95%
  |                                                        
  |--------------------------------------------------| 100%
## </code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="financial-score-card-model.html#cb53-1" tabindex="-1"></a>iv_summary<span class="ot">=</span> <span class="fu">na.omit</span>(iv_summary)</span>
<span id="cb53-2"><a href="financial-score-card-model.html#cb53-2" tabindex="-1"></a><span class="fu">smbinning.sumiv.plot</span>(iv_summary)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="financial-score-card-model.html#cb54-1" tabindex="-1"></a>iv_summary</span></code></pre></div>
<pre><code>##        Char     IV            Process
## 4    TMJOB1 0.1993 Numeric binning OK
## 2    PERS_H 0.1845  Factor binning OK
## 19    CARDS 0.1812  Factor binning OK
## 9   EC_CARD 0.1563  Factor binning OK
## 8    INCOME 0.1388 Numeric binning OK
## 1  CHILDREN 0.0700  Factor binning OK
## 5       TEL 0.0692  Factor binning OK
## 17     PROF 0.0645  Factor binning OK
## 6   NMBLOAN 0.0542  Factor binning OK
## 18      CAR 0.0367  Factor binning OK
## 3     TMADD 0.0305 Numeric binning OK
## 7   FINLOAN 0.0298  Factor binning OK
## 15  PRODUCT 0.0199  Factor binning OK
## 13     REGN 0.0192  Factor binning OK
## 12    LOANS 0.0168  Factor binning OK
## 10   BUREAU 0.0041  Factor binning OK
## 16    RESID 0.0032  Factor binning OK
## 11 LOCATION 0.0006  Factor binning OK
## 20       GB 0.0000  Factor binning OK
## 21   _freq_ 0.0000  Factor binning OK</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="financial-score-card-model.html#cb56-1" tabindex="-1"></a>imp_vars<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb56-2"><a href="financial-score-card-model.html#cb56-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iv_summary<span class="sc">$</span>Char)){</span>
<span id="cb56-3"><a href="financial-score-card-model.html#cb56-3" tabindex="-1"></a>  <span class="cf">if</span> (iv_summary<span class="sc">$</span>IV[i]<span class="sc">&gt;=</span>.<span class="dv">10</span>){</span>
<span id="cb56-4"><a href="financial-score-card-model.html#cb56-4" tabindex="-1"></a>    imp_vars<span class="ot">=</span><span class="fu">append</span>(imp_vars, iv_summary<span class="sc">$</span>Char[i])</span>
<span id="cb56-5"><a href="financial-score-card-model.html#cb56-5" tabindex="-1"></a>  }</span>
<span id="cb56-6"><a href="financial-score-card-model.html#cb56-6" tabindex="-1"></a>}</span>
<span id="cb56-7"><a href="financial-score-card-model.html#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="financial-score-card-model.html#cb56-8" tabindex="-1"></a><span class="co">#just using train 0 to just get the important vars names  </span></span>
<span id="cb56-9"><a href="financial-score-card-model.html#cb56-9" tabindex="-1"></a>train0<span class="ot">=</span>train[,<span class="fu">c</span>(imp_vars)]</span>
<span id="cb56-10"><a href="financial-score-card-model.html#cb56-10" tabindex="-1"></a></span>
<span id="cb56-11"><a href="financial-score-card-model.html#cb56-11" tabindex="-1"></a><span class="co">#Binning Just the Important Vars</span></span>
<span id="cb56-12"><a href="financial-score-card-model.html#cb56-12" tabindex="-1"></a></span>
<span id="cb56-13"><a href="financial-score-card-model.html#cb56-13" tabindex="-1"></a>num_names0 <span class="ot">=</span> <span class="fu">names</span>(train0)[<span class="fu">sapply</span>(train0, is.numeric)] <span class="co"># Gathering the names of numeric variables in data #</span></span>
<span id="cb56-14"><a href="financial-score-card-model.html#cb56-14" tabindex="-1"></a>num_names0<span class="ot">=</span>num_names0[num_names0 <span class="sc">!=</span> <span class="st">&quot;good&quot;</span>]</span>
<span id="cb56-15"><a href="financial-score-card-model.html#cb56-15" tabindex="-1"></a></span>
<span id="cb56-16"><a href="financial-score-card-model.html#cb56-16" tabindex="-1"></a>results_all_sig_num <span class="ot">=</span> <span class="fu">list</span>() <span class="co"># Creating empty list to store all results #</span></span>
<span id="cb56-17"><a href="financial-score-card-model.html#cb56-17" tabindex="-1"></a>results_all_sig_char <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb56-18"><a href="financial-score-card-model.html#cb56-18" tabindex="-1"></a><span class="co">#iv_summary &lt;- smbinning.sumiv(df = train0, y = &quot;good&quot;)</span></span>
<span id="cb56-19"><a href="financial-score-card-model.html#cb56-19" tabindex="-1"></a><span class="co">#iv_summary= na.omit(iv_summary)</span></span>
<span id="cb56-20"><a href="financial-score-card-model.html#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="financial-score-card-model.html#cb56-21" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(num_names0)){</span>
<span id="cb56-22"><a href="financial-score-card-model.html#cb56-22" tabindex="-1"></a>  results_all_sig_num[[num_names0[i]]] <span class="ot">&lt;-</span> <span class="fu">smbinning</span>(<span class="at">df =</span> train, <span class="at">y =</span> <span class="st">&quot;good&quot;</span>, <span class="at">x =</span> num_names0[i])</span>
<span id="cb56-23"><a href="financial-score-card-model.html#cb56-23" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2

## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="financial-score-card-model.html#cb58-1" tabindex="-1"></a>char_names0 <span class="ot">=</span><span class="fu">names</span>(train0)[<span class="fu">sapply</span>(train0, is.factor)]</span>
<span id="cb58-2"><a href="financial-score-card-model.html#cb58-2" tabindex="-1"></a>char_names0<span class="ot">=</span>char_names0[char_names0 <span class="sc">!=</span> <span class="st">&quot;GB&quot;</span>]</span>
<span id="cb58-3"><a href="financial-score-card-model.html#cb58-3" tabindex="-1"></a>char_names0<span class="ot">=</span>char_names0[char_names0 <span class="sc">!=</span> <span class="st">&quot;_freq_&quot;</span>]</span>
<span id="cb58-4"><a href="financial-score-card-model.html#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="financial-score-card-model.html#cb58-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(char_names0)){</span>
<span id="cb58-6"><a href="financial-score-card-model.html#cb58-6" tabindex="-1"></a>  results_all_sig_char[[char_names0[i]]] <span class="ot">&lt;-</span> <span class="fu">smbinning.factor</span>(<span class="at">df =</span> train, <span class="at">y =</span> <span class="st">&quot;good&quot;</span>, <span class="at">x =</span> char_names0[i])</span>
<span id="cb58-7"><a href="financial-score-card-model.html#cb58-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2

## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2

## Warning in rbind(deparse.level, ...): number of columns of result, 14, is not a multiple of vector length 13 of arg 2</code></pre>
<hr />
<hr />
<p>Generating Variables of Bins and WOE Values</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="financial-score-card-model.html#cb60-1" tabindex="-1"></a><span class="co"># Generating Variables of Bins #</span></span>
<span id="cb60-2"><a href="financial-score-card-model.html#cb60-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results_all_sig_num)) {</span>
<span id="cb60-3"><a href="financial-score-card-model.html#cb60-3" tabindex="-1"></a>  train <span class="ot">&lt;-</span> <span class="fu">smbinning.gen</span>(<span class="at">df =</span> train, <span class="at">ivout =</span> results_all_sig_num[[i]], <span class="at">chrname =</span> <span class="fu">paste</span>(results_all_sig_num[[i]]<span class="sc">$</span>x, <span class="st">&quot;_bin&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb60-4"><a href="financial-score-card-model.html#cb60-4" tabindex="-1"></a>}</span>
<span id="cb60-5"><a href="financial-score-card-model.html#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="financial-score-card-model.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="financial-score-card-model.html#cb60-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results_all_sig_char)) {</span>
<span id="cb60-8"><a href="financial-score-card-model.html#cb60-8" tabindex="-1"></a>  train <span class="ot">&lt;-</span> <span class="fu">smbinning.factor.gen</span>(<span class="at">df =</span> train, <span class="at">ivout =</span> results_all_sig_char[[i]], <span class="at">chrname =</span> <span class="fu">paste</span>(results_all_sig_char[[i]]<span class="sc">$</span>x, <span class="st">&quot;_bin&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb60-9"><a href="financial-score-card-model.html#cb60-9" tabindex="-1"></a>}</span>
<span id="cb60-10"><a href="financial-score-card-model.html#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="financial-score-card-model.html#cb60-11" tabindex="-1"></a><span class="co"># Generating Variables WOE Values from Bins just created #</span></span>
<span id="cb60-12"><a href="financial-score-card-model.html#cb60-12" tabindex="-1"></a></span>
<span id="cb60-13"><a href="financial-score-card-model.html#cb60-13" tabindex="-1"></a>results_all_sig<span class="ot">=</span><span class="fu">append</span>(results_all_sig_num,results_all_sig_char)</span>
<span id="cb60-14"><a href="financial-score-card-model.html#cb60-14" tabindex="-1"></a></span>
<span id="cb60-15"><a href="financial-score-card-model.html#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="financial-score-card-model.html#cb60-16" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(results_all_sig)) {</span>
<span id="cb60-17"><a href="financial-score-card-model.html#cb60-17" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(train)) {</span>
<span id="cb60-18"><a href="financial-score-card-model.html#cb60-18" tabindex="-1"></a>    bin_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(results_all_sig[[j]]<span class="sc">$</span>x, <span class="st">&quot;_bin&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb60-19"><a href="financial-score-card-model.html#cb60-19" tabindex="-1"></a>    bin <span class="ot">&lt;-</span> <span class="fu">substr</span>(train[[bin_name]][i], <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb60-20"><a href="financial-score-card-model.html#cb60-20" tabindex="-1"></a></span>
<span id="cb60-21"><a href="financial-score-card-model.html#cb60-21" tabindex="-1"></a>    woe_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(results_all_sig[[j]]<span class="sc">$</span>x, <span class="st">&quot;_WOE&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb60-22"><a href="financial-score-card-model.html#cb60-22" tabindex="-1"></a>    </span>
<span id="cb60-23"><a href="financial-score-card-model.html#cb60-23" tabindex="-1"></a>    <span class="cf">if</span>(bin <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb60-24"><a href="financial-score-card-model.html#cb60-24" tabindex="-1"></a>      bin <span class="ot">&lt;-</span> <span class="fu">dim</span>(results_all_sig[[j]]<span class="sc">$</span>ivtable)[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb60-25"><a href="financial-score-card-model.html#cb60-25" tabindex="-1"></a>      train[[woe_name]][i] <span class="ot">&lt;-</span> results_all_sig[[j]]<span class="sc">$</span>ivtable[bin, <span class="st">&quot;WoE&quot;</span>]</span>
<span id="cb60-26"><a href="financial-score-card-model.html#cb60-26" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-27"><a href="financial-score-card-model.html#cb60-27" tabindex="-1"></a>      train[[woe_name]][i] <span class="ot">&lt;-</span> results_all_sig[[j]]<span class="sc">$</span>ivtable[bin, <span class="st">&quot;WoE&quot;</span>]</span>
<span id="cb60-28"><a href="financial-score-card-model.html#cb60-28" tabindex="-1"></a>    }</span>
<span id="cb60-29"><a href="financial-score-card-model.html#cb60-29" tabindex="-1"></a>  }</span>
<span id="cb60-30"><a href="financial-score-card-model.html#cb60-30" tabindex="-1"></a>}</span></code></pre></div>
<p>Finding Out Which Vars Had Quasi Complete and then Making Sure None has INF in IV WOE</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="financial-score-card-model.html#cb61-1" tabindex="-1"></a><span class="fu">CrossTable</span>(train<span class="sc">$</span>PERS_H, train<span class="sc">$</span>good)</span></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## | Chi-square contribution |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  2100 
## 
##  
##              | train$good 
## train$PERS_H |         0 |         1 | Row Total | 
## -------------|-----------|-----------|-----------|
##            1 |       506 |       294 |       800 | 
##              |    25.861 |    26.358 |           | 
##              |     0.632 |     0.367 |     0.381 | 
##              |     0.477 |     0.283 |           | 
##              |     0.241 |     0.140 |           | 
## -------------|-----------|-----------|-----------|
##            2 |       176 |       265 |       441 | 
##              |     9.755 |     9.943 |           | 
##              |     0.399 |     0.601 |     0.210 | 
##              |     0.166 |     0.255 |           | 
##              |     0.084 |     0.126 |           | 
## -------------|-----------|-----------|-----------|
##            3 |       167 |       225 |       392 | 
##              |     4.815 |     4.908 |           | 
##              |     0.426 |     0.574 |     0.187 | 
##              |     0.158 |     0.216 |           | 
##              |     0.080 |     0.107 |           | 
## -------------|-----------|-----------|-----------|
##            4 |       148 |       195 |       343 | 
##              |     3.649 |     3.719 |           | 
##              |     0.431 |     0.569 |     0.163 | 
##              |     0.140 |     0.188 |           | 
##              |     0.070 |     0.093 |           | 
## -------------|-----------|-----------|-----------|
##            5 |        42 |        43 |        85 | 
##              |     0.019 |     0.019 |           | 
##              |     0.494 |     0.506 |     0.040 | 
##              |     0.040 |     0.041 |           | 
##              |     0.020 |     0.020 |           | 
## -------------|-----------|-----------|-----------|
##            6 |        17 |         8 |        25 | 
##              |     1.521 |     1.550 |           | 
##              |     0.680 |     0.320 |     0.012 | 
##              |     0.016 |     0.008 |           | 
##              |     0.008 |     0.004 |           | 
## -------------|-----------|-----------|-----------|
##           7+ |         4 |        10 |        14 | 
##              |     1.331 |     1.356 |           | 
##              |     0.286 |     0.714 |     0.007 | 
##              |     0.004 |     0.010 |           | 
##              |     0.002 |     0.005 |           | 
## -------------|-----------|-----------|-----------|
## Column Total |      1060 |      1040 |      2100 | 
##              |     0.505 |     0.495 |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="financial-score-card-model.html#cb63-1" tabindex="-1"></a>results_all_sig[[<span class="st">&quot;PERS_H&quot;</span>]][[<span class="st">&quot;ivtable&quot;</span>]]</span></code></pre></div>
<pre><code>##   Cutpoint CntRec CntGood CntBad CntCumRec CntCumGood CntCumBad PctRec GoodRate BadRate   Odds  LnOdds     WoE     IV
## 1    = &#39;1&#39;    800     294    506       800        294       506 0.3810   0.3675  0.6325 0.5810 -0.5430 -0.5239 0.1020
## 2    = &#39;2&#39;    441     265    176      1241        559       682 0.2100   0.6009  0.3991 1.5057  0.4092  0.4283 0.0380
## 3    = &#39;3&#39;    392     225    167      1633        784       849 0.1867   0.5740  0.4260 1.3473  0.2981  0.3172 0.0187
## 4    = &#39;4&#39;    343     195    148      1976        979       997 0.1633   0.5685  0.4315 1.3176  0.2758  0.2948 0.0141
## 5    = &#39;5&#39;     85      43     42      2061       1022      1039 0.0405   0.5059  0.4941 1.0238  0.0235  0.0426 0.0001
## 6    = &#39;6&#39;     25       8     17      2086       1030      1056 0.0119   0.3200  0.6800 0.4706 -0.7538 -0.7347 0.0061
## 7   = &#39;7+&#39;     14      10      4      2100       1040      1060 0.0067   0.7143  0.2857 2.5000  0.9163  0.9353 0.0055
## 8  Missing      0       0      0      2100       1040      1060 0.0000      NaN     NaN    NaN     NaN     NaN    NaN
## 9    Total   2100    1040   1060        NA         NA        NA 1.0000   0.4952  0.5048 0.9811 -0.0190  0.0000 0.1845</code></pre>
<p>Building Initial Scorecard Model</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="financial-score-card-model.html#cb65-1" tabindex="-1"></a><span class="co">#need to fix gb var in test</span></span>
<span id="cb65-2"><a href="financial-score-card-model.html#cb65-2" tabindex="-1"></a>test<span class="sc">$</span>GB<span class="ot">=</span><span class="fu">ifelse</span>(test<span class="sc">$</span>GB<span class="sc">==</span><span class="st">&quot;0&quot;</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb65-3"><a href="financial-score-card-model.html#cb65-3" tabindex="-1"></a>train<span class="sc">$</span>GB<span class="ot">=</span><span class="fu">ifelse</span>(train<span class="sc">$</span>GB<span class="sc">==</span><span class="st">&quot;0&quot;</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb65-4"><a href="financial-score-card-model.html#cb65-4" tabindex="-1"></a>initial_score <span class="ot">&lt;-</span> <span class="fu">glm</span>(GB <span class="sc">~</span> </span>
<span id="cb65-5"><a href="financial-score-card-model.html#cb65-5" tabindex="-1"></a>                       TMJOB1_WOE <span class="sc">+</span> </span>
<span id="cb65-6"><a href="financial-score-card-model.html#cb65-6" tabindex="-1"></a>                       INCOME_WOE <span class="sc">+</span></span>
<span id="cb65-7"><a href="financial-score-card-model.html#cb65-7" tabindex="-1"></a>                       CARDS_WOE <span class="sc">+</span> <span class="co">#quasi complete seperation issue with this var</span></span>
<span id="cb65-8"><a href="financial-score-card-model.html#cb65-8" tabindex="-1"></a>                       PERS_H_WOE, <span class="co">#quasi complete seperation issue with this var</span></span>
<span id="cb65-9"><a href="financial-score-card-model.html#cb65-9" tabindex="-1"></a>                       <span class="co">#EC_CARD_WOE, dogwater predictor</span></span>
<span id="cb65-10"><a href="financial-score-card-model.html#cb65-10" tabindex="-1"></a>                     <span class="at">data =</span> train,</span>
<span id="cb65-11"><a href="financial-score-card-model.html#cb65-11" tabindex="-1"></a>                     <span class="at">weights =</span> <span class="fu">as.numeric</span>(train<span class="sc">$</span><span class="st">`</span><span class="at">_freq_</span><span class="st">`</span>), </span>
<span id="cb65-12"><a href="financial-score-card-model.html#cb65-12" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb65-13"><a href="financial-score-card-model.html#cb65-13" tabindex="-1"></a></span>
<span id="cb65-14"><a href="financial-score-card-model.html#cb65-14" tabindex="-1"></a><span class="fu">summary</span>(initial_score)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = GB ~ TMJOB1_WOE + INCOME_WOE + CARDS_WOE + PERS_H_WOE, 
##     family = &quot;binomial&quot;, data = train, weights = as.numeric(train$`_freq_`))
## 
## Coefficients:
##             Estimate Std. Error z value             Pr(&gt;|z|)    
## (Intercept) -0.67293    0.04019 -16.745 &lt; 0.0000000000000002 ***
## TMJOB1_WOE  -0.89442    0.09564  -9.352 &lt; 0.0000000000000002 ***
## INCOME_WOE   0.11558    0.25362   0.456                0.649    
## CARDS_WOE   -1.08132    0.22153  -4.881           0.00000106 ***
## PERS_H_WOE  -0.83298    0.09204  -9.050 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4015.5  on 2099  degrees of freedom
## Residual deviance: 3677.2  on 2095  degrees of freedom
## AIC: 3687.2
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluate-the-initial-model---training-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aidan-miller/Arsenal/edit/main/02-tears.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/aidan-miller/Arsenal/blob/main/02-tears.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
